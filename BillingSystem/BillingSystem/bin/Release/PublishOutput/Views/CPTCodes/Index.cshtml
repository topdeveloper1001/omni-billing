@*@model BillingSystem.Models.CPTCodesView*@

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href="~/css/ui.css" rel="stylesheet" />
<link href="~/css/layout-jqgrid.css" rel="stylesheet" />
<link href="~/css/font-awesome.css" rel="stylesheet" />
<div>
    <div id="wrapper">
        <section>
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <table id="jqgrid">
                        </table>
                        <div id="pager_jqgrid">
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>
<script src="~/Scripts/grid.js"></script>
<script src="~/Scripts/jquery.js"></script>
<script type="text/javascript">
    var jqgrid_data = [{
        id: "1",
        date: "2014-10-01",
        name: "Test 1",
        note: "Note 1",
        amount: "150.00",
        tax: "15.00",
        total: "210.00"
    }, {
        id: "2",
        date: "2014-10-02",
        name: "Test 2",
        note: "Note 2",
        amount: "220.00",
        tax: "22.00",
        total: "320.00"
    }, {
        id: "3",
        date: "2014-09-01",
        name: "Test 3",
        note: "Note 3",
        amount: "40.00",
        tax: "4.00",
        total: "430.00"
    }, {
        id: "4",
        date: "2014-10-04",
        name: "Test 4",
        note: "Note 4",
        amount: "510.00",
        tax: "51.00",
        total: "210.00"
    }, {
        id: "5",
        date: "2014-10-05",
        name: "Test 5",
        note: "Note 5",
        amount: "210.00",
        tax: "21.00",
        total: "320.00"
    }, {
        id: "6",
        date: "2014-09-06",
        name: "Test 6",
        note: "Note 6",
        amount: "70.00",
        tax: "7.00",
        total: "430.00"
    }, {
        id: "7",
        date: "2014-10-04",
        name: "Test 7",
        note: "Note 7",
        amount: "80.00",
        tax: "10.00",
        total: "210.00"
    }, {
        id: "8",
        date: "2014-10-03",
        name: "Test 8",
        note: "Note 8",
        amount: "300.00",
        tax: "10.00",
        total: "320.00"
    }, {
        id: "9",
        date: "2014-09-01",
        name: "Test 9",
        note: "Note 9",
        amount: "90.00",
        tax: "10.00",
        total: "430.00"
    }, {
        id: "10",
        date: "2014-10-01",
        name: "Test 10",
        note: "Note 10",
        amount: "200.00",
        tax: "20.00",
        total: "210.00"
    }, {
        id: "11",
        date: "2014-10-02",
        name: "Test 11",
        note: "Note 11",
        amount: "77.00",
        tax: "9.00",
        total: "320.00"
    }, {
        id: "12",
        date: "2014-09-01",
        name: "Test 12",
        note: "Note 12",
        amount: "56.00",
        tax: "8.00",
        total: "430.00"
    }, {
        id: "13",
        date: "2014-10-04",
        name: "Test 13",
        note: "Note 13",
        amount: "554.00",
        tax: "10.00",
        total: "210.00"
    }, {
        id: "14",
        date: "2014-10-05",
        name: "Test 14",
        note: "Note 14",
        amount: "265.00",
        tax: "2.00",
        total: "320.00"
    }, {
        id: "15",
        date: "2014-09-06",
        name: "Test 15",
        note: "Note 15",
        amount: "765.00",
        tax: "3.00",
        total: "430.00"
    }, {
        id: "16",
        date: "2014-10-04",
        name: "Test 16",
        note: "Note 16",
        amount: "89.00",
        tax: "1.00",
        total: "210.00"
    }, {
        id: "17",
        date: "2014-10-03",
        name: "Test 17",
        note: "Note 17",
        amount: "99.00",
        tax: "2.00",
        total: "320.00"
    }, {
        id: "18",
        date: "2014-09-01",
        name: "Test 18",
        note: "Note 18",
        amount: "49.00",
        tax: "3.00",
        total: "430.00"
    }];


    $("#jqgrid").jqGrid({
        url: "/CPTCodes/GetCptCodesList",
        //data: jqgrid_data,
        datatype: "json",
        mtype: 'POST',
        height: '400',
        gridview: true,
        colNames: ['Actions', 'Table Number', 'Code', 'Description', 'Code Price', 'Anesthesia BaseUnit', 'Code Group'],
        colModel: [
            { name: 'act', index: 'act', sortable: false },
            //{ name: 'CPTCodesId', index: 'CPTCodesId', hidden: true },
            { name: 'CodeTableNumber', index: 'CodeTableNumber' },
            { name: 'CodeNumbering', index: 'CodeNumbering' },
            { name: 'CodeDescription', index: 'CodeDescription', editable: true },
            { name: 'CodePrice', index: 'CodePrice', align: "right", editable: true },
            { name: 'CodeAnesthesiaBaseUnit', index: 'CodeAnesthesiaBaseUnit', align: "right", editable: true },
            { name: 'CodeGroup', index: 'CodeGroup', sortable: false }
        ],
        rowNum: 20,
        rowList: [50, 100, 200, 500, 1000, 2000, 5000, 10000],
        pager: '#pager_jqgrid',
        sortname: 'CPTCodesId',
        toolbarfilter: true,
        viewrecords: true,
        sortorder: "asc",
        gridComplete: function () {
            var ids = $("#jqgrid").jqGrid('getDataIDs');
            for (var i = 0; i < ids.length; i++) {
                var cl = ids[i];
                var be = "<button class='btn btn-xs btn-default btn-quick' title='Edit Row' onclick=\"$('#jqgrid').editRow('" + cl + "');\"><i class='fa fa-pencil'></i></button>";
                var se = "<button class='btn btn-xs btn-default btn-quick' title='Save Row' onclick=\"$('#jqgrid').saveRow('" + cl + "');\"><i class='fa fa-save'></i></button>";
                var ca = "<button class='btn btn-xs btn-default btn-quick' title='Cancel' onclick=\"$('#jqgrid').restoreRow('" + cl + "');\"><i class='fa fa-times'></i></button>";
                $("#jqgrid").jqGrid('setRowData', ids[i], { act: be + se + ca });
            }
        },
        //editurl: "dummy.html",
        caption: "CPT Codes List",
        multiselect: true,
        autowidth: true,
        autoheight: true,
    });


    //enable datepicker
    function pickDate(cellvalue, options, cell) {
        setTimeout(function () {
            $(cell).find('input[type=text]')
                .datepicker({ format: 'yyyy-mm-dd', autoclose: true });
        }, 0);
    }

    $("#jqgrid").jqGrid('navGrid', "#pager_jqgrid", {
        edit: false,
        add: false,
        del: true
    });

    $("#jqgrid").jqGrid('inlineNav', "#pager_jqgrid");

    /* Add tooltips */
    $('.navtable .ui-pg-button').tooltip({
        container: 'body'
    });

    // Get Selected ID's
    $("a.get_selected_ids").bind("click", function () {
        var s = $("#jqgrid").jqGrid('getGridParam', 'selarrrow');
        alert(s);
    });

    // Select/Unselect specific Row by id
    $("a.select_unselect_row").bind("click", function () {
        $("#jqgrid").jqGrid('setSelection', "13");
    });

    // Select/Unselect specific Row by id
    $("a.delete_row").bind("click", function () {
        var su = $("#jqgrid").jqGrid('delRowData', 1);
        if (su) alert("Succes. Write custom code to delete row from server");
        else alert("Already deleted or not in list");
    });


    // On Resize
    $(window).resize(function () {

        if (window.afterResize) {
            clearTimeout(window.afterResize);
        }

        window.afterResize = setTimeout(function () {

            /**
                After Resize Code
                .................
            **/

            $("#jqgrid").jqGrid('setGridWidth',
                $(".ui-jqgrid").parent().width());

        }, 500);

    });




    /*
    Styling..
    */
    $(".ui-jqgrid").removeClass("ui-widget ui-widget-content");
    $(".ui-jqgrid-view").children().removeClass("ui-widget-header ui-state-default");
    $(".ui-jqgrid-labels,.ui-search-toolbar").children().removeClass("ui-state-default ui-th-column ui-th-ltr");
    $(".ui-jqgrid-pager").removeClass("ui-state-default");
    $(".ui-jqgrid").removeClass("ui-widget-content");

    $(".ui-jqgrid-htable").addClass("table table-bordered table-hover");
    $(".ui-pg-div").removeClass().addClass("btn btn-sm btn-primary");
    $(".ui-icon.ui-icon-plus").removeClass().addClass("fa fa-plus");
    $(".ui-icon.ui-icon-pencil").removeClass().addClass("fa fa-pencil");
    $(".ui-icon.ui-icon-trash").removeClass().addClass("fa fa-trash-o");
    $(".ui-icon.ui-icon-search").removeClass().addClass("fa fa-search");
    $(".ui-icon.ui-icon-refresh").removeClass().addClass("fa fa-refresh");
    $(".ui-icon.ui-icon-disk").removeClass().addClass("fa fa-save").parent(".btn-primary").removeClass("btn-primary").addClass("btn-success");

    $(".ui-icon.ui-icon-cancel").removeClass().addClass("fa fa-times").parent(".btn-primary").removeClass("btn-primary").addClass("btn-danger");


    $(".ui-icon.ui-icon-seek-prev").wrap("<div class='btn btn-sm btn-default'></div>");
    $(".ui-icon.ui-icon-seek-prev").removeClass().addClass("fa fa-backward");

    $(".ui-icon.ui-icon-seek-first").wrap("<div class='btn btn-sm btn-default'></div>");
    $(".ui-icon.ui-icon-seek-first").removeClass().addClass("fa fa-fast-backward");

    $(".ui-icon.ui-icon-seek-next").wrap("<div class='btn btn-sm btn-default'></div>");
    $(".ui-icon.ui-icon-seek-next").removeClass().addClass("fa fa-forward");

    $(".ui-icon.ui-icon-seek-end").wrap("<div class='btn btn-sm btn-default'></div>");
    $(".ui-icon.ui-icon-seek-end").removeClass().addClass("fa fa-fast-forward");
</script>
@*<script>
    $(function () {
        setTimeout(function () {
            var jsonData = JSON.stringify({
                categoryId: '4242'
            });
            $.ajax({
                type: "POST",
                url: "/Home/GetGlobalCodes",
                async: false,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                data: jsonData,
                success: function (data) {
                    if (data) {
                        var selector = ".test1";
                        $(selector).empty();
                        var items = '<option value="0">--Select--</option>';
                        $.each(data, function (i, globalCode) {
                            items += "<option value='" + globalCode.GlobalCodeValue + "'>" + globalCode.GlobalCodeName + "</option>";
                        });
                        $(selector).html(items);
                    }
                    else {
                    }
                },
                error: function (msg) {
                }
            });
        }, 1000);
    });
</script>*@
